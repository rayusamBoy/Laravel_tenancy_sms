"use strict";$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$((()=>$("table.float-head").floatThead())),$("table.float-head").on("floatThead",(function(e,t,o){$("table tr.hide").toggle(!t)}));const blockUI=(e="Please wait...",t="orange")=>$.blockUI({message:`<i class="mr-1 m-auto material-symbols-rounded spinner">progress_activity</i> ${e}`,css:{padding:"3px",color:t,backgroundColor:"rgba(189, 189, 189, 0.05)",border:"none"}}),unblockUI=()=>$.unblockUI();$(window).on("load",unblockUI),autosize($("textarea")),$(document).ready((()=>{$("form.page-block").on("submit",(()=>blockUI())),$(".date-pick").datepicker({format:"mm/dd/yyyy",autoclose:!0}),$(".date-pick-day-none").datepicker({format:"M, yyyy",autoclose:!0}),$("select#user_type").on("change",(function(){const e=$(this).closest("fieldset").find("#parent-data"),t=$("#parent-data input"),o=$(".steps ul li.last"),n=$(".actions ul li:last-child"),s=$(".actions ul li").not(":last-child"),a=$(".wizard > .steps > ul > li.current");if("parent"===$(this).find(":selected").attr("class"))o.hide(),e.show("150"),s.hide(),n.show(),a.addClass("d-li-current-none"),t.prop("disabled",!1);else{o.show(),e.hide("150"),s.show(),n.hide(),a.removeClass("d-li-current-none"),t.attr("disabled",!0);const i=$(".wizard > .actions > ul > li + li");i.hasClass("disabled")&&i.removeClass("disabled").removeAttr("disabled").children("a").removeClass("disabled")}}));const e=$(".items-wrapper");$(document).on("click","#add-item",(function(t){t.preventDefault();const o=$(this).siblings("input").val();if(o<0)for(let t=0;t>o;t--){const t=e.find(".item");if(1===t.length)return;t.last().remove()}else for(let t=0;t<o;t++){const t=$(".item:first").clone().appendTo(e);t.find(".item-input").val(""),t.find(".item-output").text(""),t.find(".icon-close").show(250),t.find(".item-copy").prop("disabled",!0)}})),$(document).on("click",".item-copy",(function(e){e.preventDefault();const o=$(this).siblings(".item-output");let n="";o.each(((e,t)=>{n+=$(t).text()+"\n"}));const s=n.trim();t(s,this)}));const t=(e,t)=>{if(navigator.clipboard)navigator.clipboard.writeText(e).then((()=>o(t)),(e=>{o(t,"Failed! Try copying manually")}));else{const n=$("<textarea>").val(e).appendTo("body").select();try{document.execCommand("copy"),o(t)}catch(e){o(t,"Failed! Try copying manually")}n.remove()}function o(e,t="Copied"){"Copied"==t?$(e).text("check"):$(e).text("error"),$(e).attr("data-original-title",t).tooltip("show")}setTimeout((()=>{const e=$(t).data("title")??"Copy";$(t).text("content_copy"),$(t).attr("data-original-title",e).tooltip("hide")}),3e3)};$(document).on("click","#btn-convert",(function(e){o(this.children);const t=$("#from-out-of"),i=$("#to-out-of"),l=$(".item-input");if(!s(t,i))return void n(this.children);const r=t.val(),c=i.val();l.each((function(){const e=$(this).parent().siblings().find(".item-output"),t=$(this).parent().siblings().find(".item-copy");a(this,r)&&(e.text(u($(this).val(),r,c)),t.prop("disabled",!1))})),n(this.children)}));const o=e=>$(e).addClass("spinner"),n=e=>$(e).removeClass("spinner"),s=(e,t)=>d(e)||d(t)?(d(e)?i(e):l(e),d(t)?i(t):l(t),!1):(l(e),l(t),!0),a=(e,t)=>{if(d($(e))&&i($(e)),!d($(e))){if(!(parseInt($(e).val(),10)>parseInt(t,10)))return l(e),!0;c(e,`The mark must not be greater than ${t}`)}};$(document).on("input","input",(function(){d($(this))?r(this):l(this)}));const i=e=>e.addClass("is-invalid").siblings(".invalid-feedback").children("span").text("This field is required"),l=e=>$(e).removeClass("is-invalid"),r=e=>$(e).addClass("is-invalid"),c=(e,t)=>$(e).addClass("is-invalid").siblings(".invalid-feedback").children("span").text(t),d=e=>""===e.val(),u=(e,t,o)=>Math.round(e/t*o)})),$(".full-screen-handle").on("click",(function(e){e.preventDefault(),document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?(document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),$(this).find("a").text("fullscreen_exit").attr("title","Exit Full Screen")):(document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),$(this).find("a").text("fullscreen").attr("title","Request Full Screen"))}));const counterUp=window.counterUp.default,callback=e=>{e.forEach((e=>{const t=e.target;e.isIntersecting&&!$(t).hasClass("is-visible")&&(counterUp(t,{duration:2e3,delay:16}),$(t).addClass("is-visible"))}))},IO=new IntersectionObserver(callback,{threshold:1});$(".counter").each(((e,t)=>IO.observe(t)));const initializePopover=()=>$('[data-toggle="popover"]').popover(),initializeTooltip=()=>$('[data-toggle="tooltip"]').tooltip(),hideAllPopover=()=>$('[data-toggle="popover"]').popover("hide");$(document).ready((()=>{$('[data-toggle="popover"]').popover(),$('[data-toggle="tooltip"]').tooltip()})),$(".st-id-checkbox").on("click",(function(){const e=$("form.print-selected"),t=$(":checkbox:checked").length;e.find("button[type='submit']").prop("disabled",0===t).toggleClass("cursor-not-allowed",0===t),e.find("#checked-count").html(t)}));const enableElement=e=>$(e).prop("disabled",!1),disableElement=e=>$(e).prop("disabled",!0),updateSectionDisableState=()=>$("#students-ids").val().length?disableElement("#sec_id_add_not_applicable"):enableElement("#sec_id_add_not_applicable"),hide=(e,t=0)=>$(e).hide(t),show=(e,t=0)=>$(e).show(t),showFormCard=()=>{show(".card#create-message",500),hide("button#new-message",50)},hideFormCard=()=>{hide(".card#create-message",150),show("button#new-message",250)},toggleElementDisabledState=(e,t)=>{$(t).attr("disabled",e.length>0)};$(document).on("change","select#user_types-ids",(function(){const e=0,t=1,o="students",n=$(this).val();let s=0;n.forEach((n=>{[e,t,o].includes(n)&&s++})),s>1&&($("#user_types-ids").val("").trigger("change"),pop({msg:"Please, select only one option under students user type group.",type:"info"}))})),$("button.opt-all-as-graduate").on("click",(function(){const e=$(this).siblings("form.page-block");e.find('select option[value="G"]').prop("selected",!0),e.find(".select2-selection__rendered").text("Graduated")}));const $doNotShowButton=$('<button type="button" class="btn btn-sm btn-info pt-0 pb-0 pr-1 pl-1 position-absolute right-0 font-size-xs do-not-show-again" style="bottom: -10px;" onclick="doNotShowAgain(this)">Do not show again</button>');$(".has-do-not-show-again-button").append($doNotShowButton);const doNotShowAgain=e=>{const t=$(e).closest(".has-do-not-show-again-button"),o=t.attr("id");if(!o)return;if($(`[id="${o}"]`).length>1)return;let n=JSON.parse(Cookies.get("do_not_show_els_with_these_ids_again")||"[]");n.push(o),Cookies.set("do_not_show_els_with_these_ids_again",JSON.stringify(n)),updateHiddenIDs(n,t)},updateHiddenIDs=(e,t)=>{const o=t.find("button.do-not-show-again");o.hide(),$.ajax({url:update_hidden_alerts_url,method:"POST",data:{hidden_alert_ids:e},success:e=>{if(e.ok&&e.msg)return removeElement(t),void flash({msg:"Done. To view this again, go to <strong>My Account</strong> to reveal all hidden messages.",type:"info"});o.show(250),flash({msg:"Something went wrong, can't hide alert.",type:"warning"})},error:(e,t,n)=>{o.show(250),flash({msg:"Failed to update hidden alert IDs.",type:"error"})}})};$("button#clear-do-not-show-again-alert-msgs").click((function(){Modal.fire({title:"Are you sure?",text:"This will reveal all hidden alert messages.",icon:"warning",confirmButtonText:"Sure",customClass:{confirmButton:"bg-danger"}}).then((e=>{e.isConfirmed&&$.ajax({url:clear_hidden_alerts_url,method:"POST",success:e=>{Cookies.remove("do_not_show_els_with_these_ids_again"),flash({msg:"Success. All alert messages are now displayed.",type:"success"})},error:(e,t,o)=>{flash({msg:"Something went wrong, cannot clear IDs.",type:"error"})}})}))}));const updatedoNotShowAgainElsState=()=>{$(document).ready((()=>{JSON.parse(Cookies.get("do_not_show_els_with_these_ids_again")||"[]").forEach((e=>{e&&$(`#${e}`).remove()}))}))};$(document).ready((()=>{JSON.parse(Cookies.get("do_not_show_els_with_these_ids_again")||"[]").forEach((e=>{e&&$(`#${e}`).remove()}))}));const removeElement=e=>{e.animate({height:"0px"},500,(function(){$(this).remove()}))};$((function(){const e=$(".go-to-bottom button");e.on("click",(e=>{e.preventDefault(),scrollToBottom()})),$(window).on("scroll",(()=>{const t=$(window).scrollTop()+$(window).height();(document.scrollingElement||document.body).scrollHeight-300<t?e.fadeOut():e.fadeIn()}))})),$(document).on("change","select#class-type",(function(){const e=this.value;$(".number-formats div").removeClass("d-flex").addClass("d-none"),$(`.number-format-${e}`).removeClass("d-none").addClass("d-flex")})),$(document).on("change","select#category",(function(){const e=this.value,t=$(this).data("summative_exm_cat_ids");if(t){Object.values(t).includes(parseInt(e,10))?$(".ca-setup").show(150).find("input[type='number']").attr("required","required"):$(".ca-setup").hide(150).find("input[type='number']").removeAttr("required")}}));const errorSoundElement=document.getElementById("notification-sounds"),notificationSound=new Audio,playNotificationSound=(e,t=!1)=>{t&&1===$(errorSoundElement).data("allow_system_sounds")&&(notificationSound.src=`${$(errorSoundElement).data("base_url")}/${e}`,notificationSound.play())};$(document).on("input","table.data-table input",(function(){const e=parseFloat($(this).attr("max")),t=parseFloat($(this).val()),o=$(this).attr("name");if(t>e)return playNotificationSound("error-call-to-attention.mp3",!0),sessionStorage.setItem(o,""),void $(this).val("").blur().attr("style","border: 1px solid rgb(151, 23, 23) !important");$(this).removeAttr("style"),sessionStorage.setItem(o,t)}));const pageReloaded=window.performance.getEntriesByType("navigation").some((e=>"reload"===e.type));$("table.data-table input").length>0&&pageReloaded&&Object.keys(sessionStorage).forEach((e=>{(e.startsWith("cw_")||e.startsWith("hw_")||e.startsWith("tt_"))&&$(".ca-tbody").find(`input[name="${e}"]`).val(sessionStorage[e]),e.startsWith("exm_")&&$(".exam-tbody").find(`input[name="${e}"]`).val(sessionStorage[e])}));const $authPagesInput=$("#login-and-related-pgs-bg-input"),$authPagesPreviewBtns=$("div.auth-pages-preview");$authPagesInput.on("change",(function(){this.files.length>=1?$authPagesPreviewBtns.find("select, input").prop("disabled",!1):$authPagesPreviewBtns.find("select, input").prop("disabled",!0)})),$(document).on("click",".refresh",(function(e){e.preventDefault(),$(this).html('<i class="material-symbols-rounded mt-auto mb-auto spinner">refresh</i>'),window.location.reload()})),function(e){const t=new Date,o=t.getDate(),n=["January","February","March","April","May","June","July","August","September","October","November","December"];e(document).ready((function(){e(".right-button").on("click",(()=>r(t))),e(".left-button").on("click",(()=>c(t))),e(".month").on("click",(function(){l(e(this),t)})),e("#add-button").on("click",(()=>d(t))),e(".months-row > td").eq(t.getMonth()).addClass("active-month"),s(t);const a=h(o,t.getMonth()+1,t.getFullYear());p(a,n[t.getMonth()],o)}));const s=t=>{e(".events-container").empty();const o=e(".tbody").empty(),s=t.getMonth(),l=t.getFullYear(),r=a(s,l),c=t.getDate();t.setDate(1);const d=t.getDay();let u=e("<tr class='table-row'></tr>");for(let t=0;t<35+d;t++){const a=t-d+1,m=e("<td class='table-date'></td>");if(t%7==0&&(o.append(u),u=e("<tr class='table-row'></tr>")),t<d||a>r)m.addClass("nil");else{m.text(a);const t=h(a,s+1,l);c===a&&0===e(".active-date").length&&(m.addClass("active-date"),p(t,n[s],a)),0!==t.length&&m.addClass("event-date"),m.on("click",(e=>i(t,n[s],a,e)))}u.append(m)}o.append(u),e(".year").text(l)},a=(e,t)=>new Date(t,e+1,0).getDate(),i=(t,o,n,s)=>{e(".events-container").show(250),e("#dialog").hide(250),e(".active-date").removeClass("active-date"),e(s.target).addClass("active-date"),p(t,o,n)},l=(t,o)=>{e(".events-container").show(250),e("#dialog").hide(250),e(".active-month").removeClass("active-month"),t.addClass("active-month");const n=e(".month").index(t);o.setMonth(n),s(o)},r=t=>{e("#dialog").hide(250);const o=t.getFullYear()+1;e(".year").text(o),t.setFullYear(o),s(t)},c=t=>{e("#dialog").hide(250);const o=t.getFullYear()-1;e(".year").text(o),t.setFullYear(o),s(t)},d=t=>{0!==e(".active-date").length&&(e("input").on("click",(function(){e(this).removeClass("error-input")})),e("#dialog input[type=text], #dialog textarea").val(""),e(".events-container").hide(250),e("#dialog").show(250),e("#cancel-button").on("click",(()=>{e("#name, #count").removeClass("error-input"),e("#dialog").hide(250),e(".events-container").show(250)})),e("#ok-button").off().on("click",(()=>{const o=e("#name").val().trim(),n=e("#count").val().trim(),a=parseInt(e(".active-date").text(),10);0===o.length?e("#name").addClass("error-input"):0===n.length?e("#count").addClass("error-input"):(e("#dialog").hide(250),u(o,n,t,a),t.setDate(a),s(t))})))},u=(e,t,o,n)=>{const s={name:e,description:t,year:o.getFullYear(),month:o.getMonth()+1,day:n};events_data.events.push(s),m(s)},m=t=>{e.ajax({type:"POST",url:event_create_url,dataType:"json",data:t,success:t=>{e(".events-container").html(t.msg).addClass("text-success")},error:t=>{e(".events-container").text("Something went wrong. Event add failed!").addClass("text-danger")}})},p=(t,o,n)=>{const s=e(".events-container").empty().show(250);if(0===t.length){const t=e("<div class='event-card'></div>"),a=e("<div class='event-name'>There are no Events Planned for "+o+" "+n+".</div>");t.css({"border-left":"10px solid #FF1744"}).append(a),s.append(t)}else t.forEach((t=>{const o=e("<div class='event-card'></div>"),n=e("<div class='event-name'>"+t.name+":</div>"),a=e("<div class='event-description pl-1'>"+t.description+".</div>");let i="";switch(t.status){case"cancelled":i=e("<div class='event-cancelled text-danger pl-1'>(Cancelled)</div>");break;case"active":i=e("<div class='event-active text-orange pl-1'>(Active now)</div>");break;case"completed":i=e("<div class='event-completed text-success pl-1'>(Completed)</div>");break;default:break}o.append(n).append(i).append(a),s.append(o)}))},h=(e,t,o)=>"undefined"!=typeof events_data?events_data.events.filter((n=>n.day===e&&n.month===t&&n.year===o)):[]}(jQuery);const Modal=Swal.mixin({focusConfirm:!1,returnFocus:!1,reverseButtons:!0,showCancelButton:!0,cancelButtonText:"No, Cancel",customClass:{cancelButton:"bg-secondary"}}),Toast=Swal.mixin({toast:!0,reverseButtons:!0,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),capitalize=e=>e.charAt(0).toUpperCase()+e.slice(1),updateNoticeStatus=e=>{const t=$(e).closest("div.notices").siblings(".card-header").find(".card-title .badge");$(`#${e.id}`).removeClass("unviewed").off("click").siblings(".iteration").remove(),t.text(0==t.text()?0:t.text()-1)};$(document).on("click",".notices button.unviewed",(function(){setNoticeAsViwed(this)}));const setNoticeAsViwed=e=>{$.ajax({dataType:"json",method:"post",data:{id:e.id},url:set_notice_as_viewed_url,success:t=>!0===t.ok&&updateNoticeStatus(e)})};$(document).on("click",".pagination a",(function(e){e.preventDefault(),$("li").removeClass("active"),$(this).parent("li").addClass("active"),getNoticesData($(this).attr("href"))}));const getNoticesData=e=>{const t=e.includes("unviewed")?"unviewed":"viewed",o=$(".notices").find(`#${t}`);o.empty().append(`<div class="notices-loading">${noticesLoadingSkin(4,t)}</div>`),$.ajax({url:e,type:"get",datatype:"html"}).done((t=>{o.replaceWith(t),window.location.hash=e})).fail((()=>{flash({msg:"Sorry, something went wrong.",type:"error"})}))};$(window).on("hashchange",(()=>{if(window.location.hash){const e=window.location.hash.replace("#","");getNoticesData(e)}}));const noticesLoadingSkin=(e,t)=>{let o="";const n=`<div class="card m-0 border-bottom-0 text-muted">\n        <div class="card-header position-relative">\n            <span class="float-left pr-10 status-styled">${s=t,s.charAt(0).toUpperCase()+s.slice(1)}</span><i class="text-muted float-right name skeleton"></i>\n        </div>\n        <div class="card-body p-1">`;var s;const a='<div class="position-relative pt-2">\n                <span class="float-right">\n                    <nav>\n                        <ul class="pagination">\n                            <li class="page-item disabled"><span class="page-link skeleton">‹</span></li>\n                            <li class="page-item disabled"><span class="page-link skeleton"></span></li>\n                            <li class="page-item disabled"><a class="page-link skeleton"></a></li>\n                            <li class="page-item disabled"><a class="page-link skeleton">›</a></li>\n                        </ul>\n                    </nav>\n                </span>\n                <span class="float-left showing skeleton"></span>\n            </div>\n        </div>\n    </div>';let i="",l="";for(let t=0;t<e;t++)i+='<div class="card mb-1">\n                <div class="card-header">\n                    <h5 class="mb-0 d-flex">\n                        <span class="text-muted iteration skeleton mr-1"></span>\n                        <button class="btn btn-link w-100 pl-1 p-0 border-left-1 border-left-info">\n                            <span class="float-left pr-10 title skeleton"></span><i class="text-muted float-right time skeleton"></i>\n                        </button>\n                    </h5>\n                </div>\n            </div>',l+='<div class="card mb-1">\n                <div class="card-header">\n                    <h5 class="mb-0 d-flex">\n                        <button class="btn btn-link w-100 pl-1 p-0 border-left-1 border-left-info">\n                            <span class="float-left pr-10 title skeleton"></span><i class="text-muted float-right time skeleton"></i>\n                        </button>\n                    </h5>\n                </div>\n            </div>';return o+="unviewed"===t?n+i+a:n+l+a,o},toggleElDisableState=(e,t)=>"none"===e?disableElement(t):enableElement(t);$("#return-to-query").on("click",(e=>{e.preventDefault(),scrollTo("#query-box")})),$("#secured-query").on("mouseenter",(function(){$(this).find("span").removeClass("text-secured")})).on("mouseleave",(function(){$(this).find("span").addClass("text-secured")}));const removeClassCursorNotAllowed=e=>$(e).removeClass("cursor-not-allowed");function getTableColumns(e){const t=$("button[type=submit]");var o;o=t,"none"==="NULL"?disableElement(o):enableElement(o);let n=get_table_cols_url.replace(":name",e);const s=$("#select"),a=$(".where"),i=$(".orderby_column");$.ajax({dataType:"json",url:n,success:e=>{a.empty().append('<option disabled selected>where</option><option value="none" selected>none (default)</option>'),$.each(e,((e,t)=>{"photo"!==e&&a.append($("<option>",{value:e,text:t}))})),i.empty().append('<option value="id" selected>id (default)</option>'),$.each(e,((e,t)=>{"photo"!==e&&i.append($("<option>",{value:e,text:t}))})),s.empty().append('<option disabled>select</option><option value="*" selected>all (default)</option>'),$.each(e,((e,t)=>{s.append($("<option>",{value:e,text:t}))}))}})}const alertInfo=e=>{Toast.fire({position:"top-right",title:`${e} total records found.`,icon:"info",timer:5e3,showConfirmButton:!1})};function getState(e,t){let o=get_state_url.replace(":id",e);const n=t?$(t):$("#state_id");$.ajax({dataType:"json",url:o,success:e=>{n.empty(),$.each(e,((e,t)=>{n.append($("<option>",{value:t.id,text:t.name}))}))}})}function getLGA(e,t){let o=get_lga_url.replace(":id",e);const n=t?$(t):$("#lga_id");$.ajax({dataType:"json",url:o,success:e=>{n.empty(),$.each(e,((e,t)=>{n.append($("<option>",{value:t.id,text:t.name}))}))}})}function getPreDefinedSubjects(e){const t=get_pre_defined_subjects_url,o=e?$(e):$("#name");$.ajax({dataType:"json",url:t,success:e=>{o.empty(),$.each(e,((e,t)=>{o.append($("<option>",{value:t,text:t}))}))}})}function getClassStudents(e,t){let o=get_class_students_url.replace(":id",e);const n=t?$(t):$("#students-ids");$.ajax({dataType:"json",url:o,success:e=>{n.empty(),$.each(e,((e,t)=>{n.append($("<option>",{value:t.id,text:t.name}))}))}})}function getClassSections(e,t){let o=get_class_sections_url.replace(":id",e);const n=t?$(t):$("#section_id");$.ajax({dataType:"json",url:o,success:e=>{n.empty(),$.each(e,((e,t)=>{n.append($("<option>",{value:t.id,text:t.name}))})),t&&(t.includes("add_all")&&n.append('<option value="all" title="All Sections">All</option>'),t.includes("add_not_applicable")&&n.prepend('<option selected value=" ">Not Applicable</option>'))},error:()=>{n.empty()}})}function getTeacherClassSections(e,t){let o=get_teacher_class_sections_url.replace(":id",e);const n=t?$(t):$("#section_id");$.ajax({dataType:"json",url:o,success:e=>{n.empty(),$.each(e,((e,t)=>{n.append($("<option>",{value:t.id,text:t.name}))}))}})}function getSubjectSectionTeacher(e,t,o){let n=get_subject_section_teacher_url.replace(":sub_id",e).replace(":sec_id",t);const s=o?$(o):$("#teacher_id");$.ajax({dataType:"json",url:n,success:e=>{s.children("option").each((function(){$(this).val()==e.id?($(this).attr("selected","selected"),$("#select2-teacher_id-container").text(e.name).attr("title",e.name)):$(this).removeAttr("selected")}))}})}function getYearExams(e){let t=get_year_exams_url.replace(":year",e);const o=$("#exam_id");$.ajax({dataType:"json",url:t,success:e=>{o.empty(),$.each(e,((e,t)=>{o.append($("<option>",{value:t.id,text:t.name}))}))},error:()=>{o.empty()}})}function getClassSubjects(e,t){let o=get_class_subjects_url.replace(":id",e);const n=t?$(t):$("#subject_id");$.ajax({dataType:"json",url:o,success:e=>{n.empty(),$.each(e,((e,t)=>{n.append($("<option>",{value:t.id,text:t.name}))})),t&&t.includes("add_not_applicable")&&n.prepend('<option selected value=" ">Not Applicable</option>')},error:()=>{n.empty()}})}function hideShowSection(e,t){return"class"===e?unhideSection(t):hideSection(t)}function hideSection(e){return(e?$(e):$("#section_id")).closest("div.form-group").hide(150)}function unhideSection(e){return(e?$(e):$("#section_id")).closest("div.form-group").show(150)}function popConfirm(e){sessionStorage.getItem(e.msg)||Toast.fire({position:"top-right",title:e.title??"Oops...",text:e.msg,icon:e.type,showConfirmButton:!0,confirmButtonText:"Got it",customClass:{confirmButton:"w-100 swal2-restyled",footer:"swal2-footer-class"},footer:`<button class="btn btn-sm" value="${e.msg}" id="do-not-show-for-this-session">Do not show for this session.</button>`})}function flash(e){toastr.options={closeButton:!0,closeMethod:"hide",closeDuration:500,showEasing:getRandomEasingMethod(),hideEasing:getRandomEasingMethod(),closeEasing:getRandomEasingMethod(),showMethod:getRandomShowMethod(),hideMethod:getRandomHideMethod(),positionClass:"toast-top-right",preventDuplicates:!0,progressBar:!0},$.unblockUI(),displayToast(e.type,e.msg)}function displayToast(e,t){return"success"===e?toastr.success(t):"info"===e?toastr.info(t):"error"===e?(toastr.options={timeOut:0,extendedTimeOut:0,preventDuplicates:!0,closeButton:!0},toastr.error(t)):"warning"===e&&toastr.info(t)}function getRandomShowMethod(){const e=["show","slideDown","fadeIn"];return e[Math.floor(Math.random()*e.length)]}function getRandomHideMethod(){const e=["hide","slideUp","fadeOut"];return e[Math.floor(Math.random()*e.length)]}function getRandomEasingMethod(){const e=["swing","linear"];return e[Math.floor(Math.random()*e.length)]}function confirmOperation(e){Modal.fire({title:"Do you want to proceed?",icon:"warning",confirmButtonText:"Sure, Proceed",customClass:{confirmButton:"bg-danger"}}).then((t=>{t.isConfirmed&&$(`form#item-confirm-operation-${e}`).submit()}))}function confirmDelete(e){Modal.fire({title:"Are you sure?",text:"This item will be deleted.",icon:"warning",confirmButtonText:"Sure, Delete",customClass:{confirmButton:"bg-danger"}}).then((t=>{t.isConfirmed&&$(`form#item-delete-${e}`).submit()}))}function confirmPermanentDelete(e){Modal.fire({title:"Are you sure?",text:"This item will be permanently deleted.",icon:"warning",confirmButtonText:"Sure, Delete Permanently",customClass:{confirmButton:"bg-danger"}}).then((t=>{t.isConfirmed&&$(`form#item-delete-${e}`).submit()}))}function confirmPermanentDeleteTwice(e){Modal.fire({title:"Just in case",text:"Do you really wish to delete this item?",icon:"warning",confirmButtonText:"Yes, I do",customClass:{confirmButton:"bg-danger"}}).then((t=>{t.isConfirmed&&confirmPermanentDelete(e)}))}function confirmForceDelete(e,t){Modal.fire({title:"Delete Permanently?",text:"Once deleted, you will not be able to recover this item!",icon:"warning",showCancelButton:!0,confirmButtonText:"Sure, Delete Permanently",customClass:{confirmButton:"bg-danger"}}).then((o=>{o.isConfirmed&&$(`form#${t}-force-delete-${e}`).submit()}))}function confirmPublish(e){Modal.fire({title:"Are you sure?",text:"This item and its related data will be published.",icon:"warning",confirmButtonText:"Confirm",customClass:{confirmButton:"bg-success"}}).then((t=>{t.isConfirmed&&$(`form#item-publish-${e}`).submit()}))}function confirmArchive(e){Modal.fire({title:"Are you sure?",text:"This item will be archived.",icon:"warning",confirmButtonText:"Confirm",customClass:{confirmButton:"bg-success"}}).then((t=>{t.isConfirmed&&$(`form#item-archive-${e}`).submit()}))}function reverseCheckBoxAction(e){$(e).removeAttr("checked").trigger("click")}function removeItemFromSessionStorageAndFlashErrMsg(e){sessionStorage.removeItem(e);flash({msg:sessionStorage.getItem("resp.msg")??"Something went wrong. Please try again.",type:"error"})}function updateExamLockState(e,t){if("false"!==sessionStorage.getItem("update-exam-lock-ok")){const o=update_exam_lock_state_url,n=t.checked?1:0;$.ajax({method:"post",data:{id:e,locked:n},url:o,success:e=>{if(!e.ok)return e.msg&&sessionStorage.setItem("resp.msg",e.msg),rollbackUpdateExamLockAction(t)},error:()=>rollbackUpdateExamLockAction(t)})}else removeItemFromSessionStorageAndFlashErrMsg("update-exam-lock-ok")}function rollbackUpdateExamLockAction(e){sessionStorage.setItem("update-exam-lock-ok","false"),reverseCheckBoxAction(e)}function updateExamEditState(e,t){if("false"!==sessionStorage.getItem("update-exam-edit-ok")){const o=update_exam_edit_state_url,n=t.checked?1:0;$.ajax({method:"post",data:{id:e,editable:n},url:o,success:e=>{if(!e.ok)return e.msg&&sessionStorage.setItem("resp.msg",e.msg),rollbackUpdateExamEditAction(t)},error:()=>rollbackUpdateExamEditAction(t)})}else removeItemFromSessionStorageAndFlashErrMsg("update-exam-edit-ok")}function rollbackUpdateExamEditAction(e){sessionStorage.setItem("update-exam-edit-ok","false"),reverseCheckBoxAction(e)}function updateStaffDataEdtiState(e,t){if("false"!==sessionStorage.getItem("update-staff-data-edit-ok")){const o=update_staff_data_edit_state_url,n=t.checked?1:0;$.ajax({method:"post",data:{id:e,staff_data_edit:n},url:o,success:e=>{if(!e.ok)return e.msg&&sessionStorage.setItem("resp.msg",e.msg),rollbackUpdateStaffDataEditAction(t)},error:()=>rollbackUpdateStaffDataEditAction(t)})}else removeItemFromSessionStorageAndFlashErrMsg("update-staff-data-edit-ok")}function rollbackUpdateStaffDataEditAction(e){sessionStorage.setItem("update-staff-data-edit-ok","false"),reverseCheckBoxAction(e)}function updateUserBlockedState(e,t){if("false"!==sessionStorage.getItem("update-user-blocked-state-ok")){const o=update_user_blocked_state_url,n=t.checked?1:0;$.ajax({method:"post",data:{id:e,blocked:n},url:o,success:e=>{if(!e.ok)return e.msg&&sessionStorage.setItem("resp.msg",e.msg),rollbackUpdateUserBlockedState(t)},error:()=>rollbackUpdateUserBlockedState(t)})}else removeItemFromSessionStorageAndFlashErrMsg("update-user-blocked-state-ok")}function rollbackUpdateUserBlockedState(e){sessionStorage.setItem("update-user-blocked-state-ok","false"),reverseCheckBoxAction(e)}function confirmReset(e,t=null){Modal.fire({title:"Are you sure?",text:"This will reset this item to default state",icon:"warning",confirmButtonText:"Sure, Reset",customClass:{confirmButton:"bg-primary"}}).then((o=>{if(o.isConfirmed){if(null===e&&null!==t)return window.location=t;$(`form#item-reset-${e}`).submit()}}))}function confirmResetTwice(e,t=null){Modal.fire({title:"Just in case",text:"Do you really want to reset this item?",icon:"warning",confirmButtonText:"Sure, Reset",customClass:{confirmButton:"bg-primary"}}).then((o=>{o.isConfirmed&&confirmReset(e,t)}))}function confirmResetPassword(e,t){Modal.fire({title:"Are you sure?",text:`This will reset password to ${t??"user"}`,icon:"warning",confirmButtonText:"Sure, Reset",customClass:{confirmButton:"bg-primary"}}).then((t=>{if(t.isConfirmed){if(e)return window.location=e;flash({msg:"Oops! Invalid URL",type:"info"})}}))}function reloadDivFn(e,t=window.location.href){$(e).parent().load(`${t} ${e}`)}function submitForm(e,t){let o=e.find("button[type=submit]");o.length||(o=e.find(".actions li:last-child a"));const n=o.html();o.hasClass("needs-time-counter")&&setTimeCounter(o),disableBtn(o);const s={url:e.attr("action"),type:"POST",cache:!1,processData:!1,dataType:"json",contentType:!1,data:new FormData(e[0])};$.ajax(s).done((s=>(closeConfirmMessageDeleteModal(),o.hasClass("needs-time-counter")&&stopTimeCounter(),hideAjaxAlert(),enableBtn(o,n),s.ok&&s.msg?s.pop?pop({msg:s.msg,type:"success",timer:s.pop_timer}):flash({msg:s.msg,type:"success"}):s.pop?pop({msg:s.msg,type:"success",timer:s.pop_timer}):flash({msg:s.msg,type:"error"}),"store"===t&&clearForm(e),o.html(n),s.scrollToBtn?scrollTo(o):s.complete?s:void scrollTo("body")))).fail((e=>(closeConfirmMessageDeleteModal(),unblockUI(),o.hasClass("needs-time-counter")&&stopTimeCounter(),422===e.status&&displayAjaxErr(e.responseJSON.errors),500===e.status&&displayAjaxErr([`${e.status} ${e.statusText} Please Check for Duplicate entry or Contact Administrator`]),404===e.status&&displayAjaxErr([`${e.status} ${e.statusText} - Requested Resource Not Found`]),enableBtn(o,n),e.status)))}function setTimeCounter(e){$('<span id="time-counter" class="status-styled d-inline-block"></span>').insertAfter(e),startTimeCounter()}$(document).on("click","#do-not-show-for-this-session",(function(){Swal.close(),sessionStorage.setItem(this.value,"do-not-show-for-this-session"),flash({msg:"Success. The message will not be shown again for this browser's tab session.",type:"success"})})),$("a.needs-reset-pass-confirmation").on("click",(function(e){e.preventDefault();confirmResetPassword($(this).data("href"),$(this).data("default_pass"))})),$("form.ajax-pay").on("submit",(function(e){e.preventDefault(),submitForm($(this),"store");const t=$(this).attr("id"),o=$(`td#amt-${t}`),n=$(`td#amt_paid-${t}`),s=$(`td#bal-${t}`),a=$(`#val-${t}`);let i=parseInt(o.data("amount")),l=parseInt(n.data("amount"));l+=parseInt(a.val());const r=i-l;s.text(`${r}`),n.text(`${l}`).data("amount",`${l}`),a.attr("max",r),r<1&&$(`#${t}`).fadeOut("slow").remove()})),$(document).on("submit","form.ajax-store, form.ajax-update, form#ajax-reg",(function(e){e.preventDefault();const t=$(this).hasClass("ajax-store")||"ajax-reg"===$(this).attr("id")?"store":"";submitForm($(this),t);const o=$(this).data("reload");o&&reloadDivFn(o)})),$(document).on("click",".download-receipt",(function(e){e.preventDefault(),$.get($(this).attr("href")),flash({msg:"Download in Progress",type:"info"})}));let time_interval,sec=0;const pad=e=>e>9?e:`0${e}`;function updateTimer(){$("#time-counter").html(`${pad(parseInt(sec/60,10))}:${pad(++sec%60)} elapsed.`)}function startTimeCounter(){time_interval=setInterval(updateTimer,1e3)}function stopTimeCounter(){clearInterval(time_interval)}function closeConfirmMessageDeleteModal(){return $("#confirm-message-delete .close").click()}function disableBtn(e){const t=e.data("text")?e.data("text"):"Submitting...";e.prop("disabled",!0).html(`<i class="material-symbols-rounded mr-2 spinner">progress_activity</i>${t}`)}function enableBtn(e,t){e.prop("disabled",!1).html(t)}function displayAjaxErr(e){$("#ajax-alert").show().html('<div class="alert alert-danger border-0 alert-dismissible" id="ajax-msg"><button type="button" class="close" data-dismiss="alert"><span>&times;</span></button></div>'),$.each(e,((e,t)=>{$("#ajax-msg").append(`<span><i class="material-symbols-rounded pb-2px">hdr_strong</i> ${t}</span><br/>`)})),scrollTo("body")}function scrollTo(e){$("html, body").animate({scrollTop:$(e).offset().top},2e3)}function scrollToBottom(){const e=document.scrollingElement||document.body;$("html, body").animate({scrollTop:e.scrollHeight},2e3)}function hideAjaxAlert(){$("#ajax-alert").hide()}function clearForm(e){e.find(".checked").removeClass("checked"),e.find(".select, .select-search").val([]).select2({placeholder:"Select..."}),e[0].reset()}function doElementPrint(e){e.hasClass("card-collapsed")&&e.removeClass("card-collapsed"),e.printThis({base:"https://jasonday.github.io/printThis/"})}function resizeChartInstances(){for(let e in Chart.instances)Chart.instances[e].resize()}$(".print-this").addClass("position-relative").append('<button class="position-absolute btn btn-sm pb-1 pt-1 right-0 bottom-0 print-none this" type="button">Print</button>'),$(".print-this button.this").on("click",(function(){const e=$(this).closest(".print-this");"dark"===getPreferredTheme()||"auto"===getPreferredTheme()&&window.matchMedia("(prefers-color-scheme: dark)").matches?Modal.fire({text:"Please, print while in light color mode for best visual quality.",icon:"warning",showDenyButton:!0,denyButtonText:"Let me switch",confirmButtonText:"Just Print",customClass:{confirmButton:"bg-warning",denyButton:"bg-info"}}).then((t=>{t.isConfirmed?doElementPrint(e):t.isDenied&&scrollTo("body")})):doElementPrint(e)}));const offlineDiv=document.getElementById("offline-alert"),$submitBtns=$("button[type=submit]"),currentUrl=window.location.href,updateOfflineStatus=()=>{currentUrl.includes("localhost")||(navigator.onLine?(offlineDiv.style.display="none",$submitBtns.prop("disabled",!1).removeClass("cursor-not-allowed")):(offlineDiv.style.display="inline-flex",$submitBtns.prop("disabled",!0).addClass("cursor-not-allowed")))};window.addEventListener("offline",updateOfflineStatus),window.addEventListener("online",updateOfflineStatus),updateOfflineStatus();